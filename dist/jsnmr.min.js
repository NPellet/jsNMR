/*! jsNMR 0.0.6 | (c) 2014 Norman Pellet | http://github.com/NPellet/jsNMR/copyright.txt */
define(["jquery","jsgraph","jcampconverter"],function(t,e,n){var r,s,a;return function(t){function e(t,e){return x.call(t,e)}function n(t,e){var n,i,r,s,a,o,h,l,u,p,g,c,d=e&&e.split("/"),f=v.map,m=f&&f["*"]||{};if(t){for(t=t.split("/"),a=t.length-1,v.nodeIdCompat&&w.test(t[a])&&(t[a]=t[a].replace(w,"")),"."===t[0].charAt(0)&&d&&(c=d.slice(0,d.length-1),t=c.concat(t)),u=0;u<t.length;u++)if(g=t[u],"."===g)t.splice(u,1),u-=1;else if(".."===g){if(0===u||1===u&&".."===t[2]||".."===t[u-1])continue;u>0&&(t.splice(u-1,2),u-=2)}t=t.join("/")}if((d||m)&&f){for(n=t.split("/"),u=n.length;u>0;u-=1){if(i=n.slice(0,u).join("/"),d)for(p=d.length;p>0;p-=1)if(r=f[d.slice(0,p).join("/")],r&&(r=r[i])){s=r,o=u;break}if(s)break;!h&&m&&m[i]&&(h=m[i],l=u)}!s&&h&&(s=h,o=l),s&&(n.splice(0,o,s),t=n.join("/"))}return t}function i(e,n){return function(){var i=S.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),c.apply(t,i.concat([e,n]))}}function o(t){return function(e){return n(e,t)}}function h(t){return function(e){m[t]=e}}function l(n){if(e(b,n)){var i=b[n];delete b[n],y[n]=!0,g.apply(t,i)}if(!e(m,n)&&!e(y,n))throw new Error("No "+n);return m[n]}function u(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function p(t){return function(){return v&&v.config&&v.config[t]||{}}}var g,c,d,f,m={},b={},v={},y={},x=Object.prototype.hasOwnProperty,S=[].slice,w=/\.js$/;d=function(t,e){var i,r=u(t),s=r[0];return t=r[1],s&&(s=n(s,e),i=l(s)),s?t=i&&i.normalize?i.normalize(t,o(e)):n(t,e):(t=n(t,e),r=u(t),s=r[0],t=r[1],s&&(i=l(s))),{f:s?s+"!"+t:t,n:t,pr:s,p:i}},f={require:function(t){return i(t)},exports:function(t){var e=m[t];return"undefined"!=typeof e?e:m[t]={}},module:function(t){return{id:t,uri:"",exports:m[t],config:p(t)}}},g=function(n,r,s,a){var o,u,p,g,c,v,x=[],S=typeof s;if(a=a||n,"undefined"===S||"function"===S){for(r=!r.length&&s.length?["require","exports","module"]:r,c=0;c<r.length;c+=1)if(g=d(r[c],a),u=g.f,"require"===u)x[c]=f.require(n);else if("exports"===u)x[c]=f.exports(n),v=!0;else if("module"===u)o=x[c]=f.module(n);else if(e(m,u)||e(b,u)||e(y,u))x[c]=l(u);else{if(!g.p)throw new Error(n+" missing "+u);g.p.load(g.n,i(a,!0),h(u),{}),x[c]=m[u]}p=s?s.apply(m[n],x):void 0,n&&(o&&o.exports!==t&&o.exports!==m[n]?m[n]=o.exports:p===t&&v||(m[n]=p))}else n&&(m[n]=s)},r=s=c=function(e,n,i,r,s){if("string"==typeof e)return f[e]?f[e](n):l(d(e,n).f);if(!e.splice){if(v=e,v.deps&&c(v.deps,v.callback),!n)return;n.splice?(e=n,n=i,i=null):e=t}return n=n||function(){},"function"==typeof i&&(i=r,r=s),r?g(t,e,n,i):setTimeout(function(){g(t,e,n,i)},4),c},c.config=function(t){return c(t)},r._defined=m,a=function(t,n,i){if("string"!=typeof t)throw new Error("See almond README: incorrect module build, no module name");n.splice||(i=n,n=[]),e(m,t)||e(b,t)||(b[t]=[t,n,i])},a.amd={jQuery:!0}}(),a("build_utils/almond",function(){}),a("shape.1dnmr",["jquery","jsgraph"],function(t,e){"use strict";function n(t,e){this.options=e||2}var i=5,r=e.getConstructor("graph.shape.line");return t.extend(n.prototype,r.prototype,{createDom:function(){this._createHandles(2,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"}),this._dom=document.createElementNS(this.graph.ns,"line"),this.maxLines=64,this.nbLines=0,this.maxLines=0,this.lines=new Array(this.maxLines);for(var t=this.maxLines-1;t>=0;t--)this.lines[t]=document.createElementNS(this.graph.ns,"line"),this.group.appendChild(this.lines[t]),this.lines[t].setAttribute("stroke","green");var e,n=0,i=0,r=0,s=this.graph.series[0].data[0];for(e=0;e<s.length;e+=2)Math.abs(s[e+1])>r&&(r=Math.abs(s[e+1]));for(e=0;e<s.length;e+=2)n+=s[e+1]/r;for(e=0;e<s.length;e+=2)i+=Math.pow(n-s[e+1]/r,2);i=Math.sqrt(r)*Math.sqrt(2*i/s.length),this.noiseLevel=3*i,this._dom.element=this},redrawImpl:function(){this.setHandles(),this.redrawLines(i)},redrawLines:function(){if(0!=this.maxLines){for(var t=this.findxs(),e=t.length-1;e>=0;e--){var n=this._getPosition({x:10}),i=this._getPosition({x:t[e][0]});this.lines[e]&&i.x&&this.currentPos2y&&this.currentPos1y&&e<this.maxLines&&(this.lines[e].setAttribute("stroke","green"),this.lines[e].setAttribute("x1",i.x),this.lines[e].setAttribute("x2",i.x),this.lines[e].setAttribute("y1",i.y),this.lines[e].setAttribute("y2",n.y),this.lines[e].setAttribute("on",!0))}for(var e=t.length;e<this.nbLines;e++)this.lines[e]&&(this.lines[e].setAttribute("y1",parseFloat(this.lines[e].getAttribute("y2"))),this.lines[e].setAttribute("x1",-1e6),this.lines[e].setAttribute("x2",-1e6),this.lines[e].setAttribute("on",!1));this.nbLines=t.length}},highLigthLinesY:function(t){for(var e=this.lines.length-1;e>=0;e--)"true"==this.lines[e].getAttribute("on")&&this.lines[e].setAttribute("y1",parseFloat(this.lines[e].getAttribute("y1"))-t)},findxs:function(){var t,e,n=this.serie.searchClosestValue(this.getFromData("pos").x),i=this.serie.searchClosestValue(this.getFromData("pos2").x),r=[],s=[];if(!n||!i)return!1;for(var a=n.dataIndex;a<=i.dataIndex;a++)for(t=a==n.dataIndex?n.xBeforeIndexArr:0,e=a==i.dataIndex?i.xBeforeIndexArr:this.serie.data[a].length,w=0,g=t;e>=g;g+=2)r.push(this.serie.data[a][g+0]),s.push(this.serie.data[a][g+1]);for(var a=s.length-1;a>=0;a--)Math.abs(s[a])<this.noiseLevel&&(s[a]=0);for(var o=r[1]-r[0],h=[],l=[],u=[],p=[],g=2;g<r.length-2;g++)l.push(1/35*(-3*s[g-2]+12*s[g-1]+17*s[g]+12*s[g+1]-3*s[g+2])),h.push(r[g]),u.push(1/(12*o)*(s[g-2]-8*s[g-1]+8*s[g+1]-s[g+2])),p.push(1/(7*Math.abs(2*o))*(2*s[g-2]-s[g-1]-2*s[g]-s[g+1]+2*s[g+2]));for(var c=[],d=[],f=[],m=[],a=1;a<l.length-1;a++){if(l[a]>l[a-1]&&l[a]>l[a+1]&&c.push(h[a]),u[a]<u[a-1]&&u[a]<u[a+1]&&d.push(h[a]),u[a]>u[a-1]&&u[a]>u[a+1])try{f.push([h[a],d.pop()])}catch(b){console.log("Error I don't know why")}p[a]<p[a-1]&&p[a]<p[a+1]&&m.push([h[a],l[a]])}for(var v=new Array,g=0;g<m.length;g++){for(var y=m[g],x=y[0],S=new Array,w=0;w<f.length;w++){var a=f[w];x>a[0]&&x<a[1]&&S.push(a)}if(S.length>0&&1==S.length){var A=S[0],j=A[1]-A[0],L=y[1],G=l;G.sort(function(t,e){return t-e}),j>2*o&&L>1e-4*G[0]&&v.push([x,j,L])}}return v}}),n}),a("assignment",["jquery"],function(t){"use strict";var e="http://www.w3.org/2000/svg",n=function(n){var i=this;this.options=n,this.bindingPairs=[];var r,s,a=!1,o=!1,h=!1,l={},u=[],p=[],g=function(e,o,h){if(B(),o.shiftKey){for(var l in n.graphs)n.graphs[l].lockShapes();a=!0,i[h]=e,o.preventDefault(),o.stopPropagation()}var u=e.getBBox(),p=t(e).position(),g=p.left+u.width/2,f=p.top+u.height/2;if(r.setAttribute("display","block"),r.setAttribute("x1",g),r.setAttribute("x2",g),r.setAttribute("y1",f),r.setAttribute("y2",f),s=c(h),n[c(h)].targettable){var m=d(c(h));m.each(function(){this.jsGraphIsShape?this.jsGraphIsShape.highlight(n[c(h)].targettable,"binding"):(S(n[c(h)].targettable,t(this)),t(this).attr(n[c(h)].targettable))})}},c=function(t){return"jsGraphShape"==t?"targetB":"jsGraphShape"},d=function(e){return t(n[e].dom).find(n[e].bindableFilter)},f=function(e,o,h){if(B(),s&&n[s].targettable){var l=d(s);l.each(function(){this.jsGraphIsShape?this.jsGraphIsShape.unHighlight("binding"):w(n[s].targettable,t(this))})}if(s=!1,a&&!h)return r.setAttribute("display","none"),void(a=!1);if(a){var u=o.target;r.setAttribute("display","none"),!t(u).is(n[h].bindableFilter)&&!t(u).get(0).classList.contains(n[h].bindableFilterClass)>-1?a=!1:(i[h]=o.target,a=!1,G());for(var p in n.graphs)n.graphs[p].unlockShapes()}},m=function(t){B(),a&&(r.setAttribute("x2",t.clientX+window.scrollX),r.setAttribute("y2",t.clientY+window.scrollY))},b=function(e,i){B();var r=[e];n[i].highlighted&&(r=x(i,e),y(i,r));for(var s=[],a=0,o=r.length;o>a;a++)A(j,r[a],function(e){s=s.concat(t.makeArray(x(c(i),e[c(i)])))});s=t(s),n[c(i)].highlighted&&y(c(i),s)},v=function(e,i){B();for(var r=x(i,e),s=[],a=0;a<r.length;a++)A(L,r[a],function(e){s=s.concat(t.makeArray(x(c(i),e[c(i)])))});l.jsGraphShape.map(function(){this.jsGraphIsShape.unHighlight("assignmentHighlighted")}),w(n.targetB.highlighted,l.targetB)},y=function(t,e){var i=n[t].highlighted;e[0]&&e[0].jsGraphIsShape?e.map(function(){this.jsGraphIsShape.highlight(i,"assignmentHighlighted")}):(S(i,e),e.attr(i)),l[t]=e},x=function(e,i){var r=i.getAttribute(n[e].attributeEquivalents);return t(n[e].dom).find("["+n[e].attributeEquivalents+'="'+r+'"]')},S=function(e,n){for(var i in e)for(var r=0,s=n.length;s>r;r++)t(n[r]).data("backup-"+i)||t(n[r]).data("backup-"+i,t(n[r]).attr(i))},w=function(e,n){for(var i in e)for(var r=0,s=n.length;s>r;r++)t(n[r]).attr(i,t(n[r]).data("backup-"+i))},A=function(t,e,n){for(var r=0,s=i.bindingPairs.length;s>r;r++)(i.bindingPairs[r].jsGraphShape==e||i.bindingPairs[r].targetB==e)&&(t(i.bindingPairs[r]),n&&n(i.bindingPairs[r]))},j=function(i){var r,s=t(i.jsGraphShape).offset(),a=t(i.targetB).offset(),o=t(i.jsGraphShape)[0].getBBox(),h=t(i.targetB)[0].getBBox(),l=n.domGlobal.offset();u.length>0?(r=u.pop(),r.setAttribute("display","block")):r=document.createElementNS(e,"line"),r.setAttribute("stroke","black"),r.setAttribute("x1",s.left-l.left+o.width/2),r.setAttribute("y1",s.top-l.top+o.height/2),r.setAttribute("x2",a.left-l.left+h.width/2),r.setAttribute("y2",a.top-l.top+h.height/2),i.line=r,p.push(r),C.appendChild(r)},L=function(t){t.line=!1,p.map(function(t){t.setAttribute("display","none")}),u=u.concat(p),p=[]},G=function(){var t;return(t=k(i.jsGraphShape,i.targetB))?(E(t),L(t),!1):(v(i.jsGraphShape,"jsGraphShape",!0),i.bindingPairs.push({jsGraphShape:i.jsGraphShape,targetB:i.targetB}),i.jsGraphShape.jsGraphIsShape.setStrokeDasharray("5,5"),i.jsGraphShape.jsGraphIsShape.applyStyle(),o=null,void(h=null))},E=function(t){i.bindingPairs.splice(i.bindingPairs.indexOf(t),1),L(t)},k=function(t,e){for(var n=0;n<i.bindingPairs.length;n++)if(i.bindingPairs[n].jsGraphShape==t||i.bindingPairs[n].targetB==e)return i.bindingPairs[n];return!1},B=function(){for(var e=0,r=i.bindingPairs.length;r>e;e++)t(n.jsGraphShape.dom).get(0).contains(i.bindingPairs[e].jsGraphShape)&&t(n.targetB.dom).get(0).contains(i.bindingPairs[e].targetB)||(i.bindingPairs[e]=!1)},P=function(){n.jsGraphShape.dom.on("mousedown",n.jsGraphShape.bindableFilter,function(t){g(this,t,"jsGraphShape")}),n.jsGraphShape.dom.on("mouseover",n.jsGraphShape.bindableFilter,function(){b(this,"jsGraphShape")}),n.jsGraphShape.dom.on("mouseout",n.jsGraphShape.bindableFilter,function(){v(this,"jsGraphShape")}),n.targetB.dom.on("mousedown",n.targetB.bindableFilter,function(t){g(this,t,"targetB")}),n.targetB.dom.on("mouseover",n.targetB.bindableFilter,function(){b(this,"targetB")}),n.targetB.dom.on("mouseout",n.targetB.bindableFilter,function(){v(this,"targetB")}),n.jsGraphShape.dom.on("mouseup",function(t){f(this,t,"jsGraphShape")}),n.targetB.dom.on("mouseup",function(t){f(this,t,"targetB")}),n.domGlobal.on("mouseup",function(t){f(this,t,!1)}),n.domGlobal.on("mousemove",function(t){m(t)})},C=document.createElementNS(e,"svg");C.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),C.setAttribute("xmlns",e),C.setAttribute("style","position: absolute"),C.setAttribute("width",n.domGlobal.width()),C.setAttribute("height",n.domGlobal.height()),C.setAttribute("pointer-events","none"),r=document.createElementNS(e,"line"),r.setAttribute("stroke","black"),C.appendChild(r),n.domGlobal.prepend(C),P()};return n.prototype.getAssignment=function(){var t=this;return this.bindingPairs.map(function(e){if(!e)return void 0;var n=e.jsGraphShape.getAttribute(t.options.jsGraphShape.attributeEquivalents),i=e.targetB.getAttribute(t.options.targetB.attributeEquivalents);return[n,i]})},n.prototype.removePairsWithShape=function(t){{var e=this;this.lookForPairsByA(t).map(function(t){e.removePair(t)})}},n.prototype.findElement=function(e,n){return t(this.options[e].dom).find("["+this.options[e].attributeEquivalents+'="'+n+'"]')},n.prototype.setAssignment=function(t){var e=this;e.bindingPairs=[],t.forEach(function(t){e.bindingPairs.push({jsGraphShape:e.findElement("jsGraphShape",t[0]),targetB:e.findElement("targetB",t[1])})})},n}),function(){"use strict";function t(){}function e(t,e){for(var n=t.length;n--;)if(t[n].listener===e)return n;return-1}function n(t){return function(){return this[t].apply(this,arguments)}}var i=t.prototype,r=this,s=r.EventEmitter;i.getListeners=function(t){var e,n,i=this._getEvents();if(t instanceof RegExp){e={};for(n in i)i.hasOwnProperty(n)&&t.test(n)&&(e[n]=i[n])}else e=i[t]||(i[t]=[]);return e},i.flattenListeners=function(t){var e,n=[];for(e=0;e<t.length;e+=1)n.push(t[e].listener);return n},i.getListenersAsObject=function(t){var e,n=this.getListeners(t);return n instanceof Array&&(e={},e[t]=n),e||n},i.addListener=function(t,n){var i,r=this.getListenersAsObject(t),s="object"==typeof n;for(i in r)r.hasOwnProperty(i)&&-1===e(r[i],n)&&r[i].push(s?n:{listener:n,once:!1});return this},i.on=n("addListener"),i.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},i.once=n("addOnceListener"),i.defineEvent=function(t){return this.getListeners(t),this},i.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},i.removeListener=function(t,n){var i,r,s=this.getListenersAsObject(t);for(r in s)s.hasOwnProperty(r)&&(i=e(s[r],n),-1!==i&&s[r].splice(i,1));return this},i.off=n("removeListener"),i.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},i.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},i.manipulateListeners=function(t,e,n){var i,r,s=t?this.removeListener:this.addListener,a=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(i=n.length;i--;)s.call(this,e,n[i]);else for(i in e)e.hasOwnProperty(i)&&(r=e[i])&&("function"==typeof r?s.call(this,i,r):a.call(this,i,r));return this},i.removeEvent=function(t){var e,n=typeof t,i=this._getEvents();if("string"===n)delete i[t];else if(t instanceof RegExp)for(e in i)i.hasOwnProperty(e)&&t.test(e)&&delete i[e];else delete this._events;return this},i.removeAllListeners=n("removeEvent"),i.emitEvent=function(t,e){var n,i,r,s,a,o=this.getListenersAsObject(t);for(s in o)if(o.hasOwnProperty(s))for(n=o[s].slice(0),r=0;r<n.length;r++)i=n[r],i.once===!0&&this.removeListener(t,i.listener),a=i.listener.apply(this,e||[]),a===this._getOnceReturnValue()&&this.removeListener(t,i.listener);return this},i.trigger=n("emitEvent"),i.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},i.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},i._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},i._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return r.EventEmitter=s,t},"function"==typeof a&&a.amd?a("../lib/components/eventEmitter/EventEmitter",[],function(){return t}):"object"==typeof module&&module.exports?module.exports=t:r.EventEmitter=t}.call(this),a(["jquery","jsgraph","./shape.1dnmr","./assignment","jcampconverter","../lib/components/eventEmitter/EventEmitter"],function(t,e,n,r,s,o){function h(e,n,i){var r=[];for(var a in n)r.push(t.get(n[a]).then(function(t){return s.convert(t,{keepSpectra:!0})}));e.divLoading||(e.divLoading=t("<div />").css({width:e.getDom().width(),height:e.getDom().height(),position:"absolute",backgroundColor:"rgba(200, 200, 200, 0.5)",textAlign:"center",lineHeight:e.getDom().height()+"px",fontSize:"2em",border:"1px solid #c0c0c0"}).html("Loading..."),e.getDom().prepend(e.divLoading)),e.loading=e.loading||0,e.loading++,t.when.apply(t,r).then(function(){var t=0;for(a in n)n[a]=arguments[t],t++;e.loading--,0==e.loading&&(e.divLoading.remove(),e.divLoading=!1),e.series.push(n),e.loaded(n,i,"a"+Math.random())})}function l(e){var n=this;switch(this.options=t.extend(!0,{},u,e),this.series=[],this.graphs,this.integrals=[],n.options.dom.append("<div />"),n.makeGraph(),this.options.mode){case"2d":break;case"1d":this.legend=this.graphs.makeLegend({frame:!0,frameWidth:2,frameColor:"grey",movable:!0,backgroundColor:"white"}),this.legend.setPosition({x:"300px",y:"40px"},"right")}this.options.assignment&&(this.assignement=new r(t.extend(this.options.assignment,{graphs:{x:this.graphs},domGraphs:this.options.dom}))),this.heightIntegral1=150}var u={mode:"1d",molecule:!1,urls:{}};e.registerConstructor("graph.shape.1dnmr",n);var p={urls:{}};return l.prototype=new o,l.prototype.load=function(e){var e=t.extend(!0,{},p,e),n={};switch(this.options.mode){case"1d":e.urls.oneD=e.url||e.urls.oneD||e.urls.x,n.x=e.urls.oneD}h(this,n,e)},l.prototype.integralCreated=function(t){t.setSerie(this.graphs.selectedSerie?this.graphs.selectedSerie:this.graphs.getSerie(0)),t.addClass("bindable"),this.integrals.push(t),this.emit("integralCreated")},l.prototype.integralChanged=function(){this.recalculateIntegrals(),this.emit("integralChanged")},l.prototype.integralRemoved=function(t){nmr.integrals.splice(nmr.integrals.indexOf(i),1),nmr.recalculateIntegrals(),this.assignement.removePairsWithShape(t),this.emit("integralRemoved")},l.prototype.recalculateIntegrals=function(){var t=this,e=t.integrals.length;1==e&&(t.ratio=t.heightIntegral1/t.integrals[0].sum,t.ratioSum=t.integrals[0].sum);for(var n=0;e>n;n++){t.integrals[n].ratio=t.ratio;var i=Math.round(t.integrals[n].sum/t.ratioSum*100)/100;isNaN(i)||t.integrals[n].setLabelText(i),t.integrals[n].updateLabels()}},l.prototype.redrawIntegrals=function(){for(var t=this.integrals.length,e=0;t>e;e++)this.integrals[e].redraw()},l.prototype.integralValueChanged=function(t){var e=parseFloat(t.getLabelText(0));this.ratioSum=t.sum/e,this.recalculateIntegrals(),this.emit("integralValueChanged")},l.prototype.getDom=function(){return this.options.dom},l.prototype.getGraph=function(){return this.graphs},l.prototype.resizeTo=function(t,e){this.graphs.resize(t,e)},l.prototype.setSerieX=function(e,n,i){this.graphs.getSerie(e)&&(this.graphs.getSerie(e).kill(),this.graphs.removeShapes(),this.integralBasis=!1);var r=this.graphs.newSerie(e,t.extend({useSlots:!0},i)).setLabel("My serie").autoAxis().setData(n).XIsMonotoneous();i.lineColor&&r.setLineColor(i.lineColor),i.lineWidth&&r.setLineWidth(i.lineWidth),i.setLineStyle&&r.setLineStyle(i.lineStyle),r.XIsMonotoneous(),r.getXAxis().setAxisDataSpacingMax(0),r.getXAxis().setAxisDataSpacingMin(0),r.getYAxis().setDisplay(!1).primaryGridOff(!1).secondaryGridOff(!1),r.getXAxis().flip(!0).setLabel("ppm").primaryGridOff(!1).secondaryGridOff(!1).setTickPosition("outside"),this.graphs.autoscaleAxes(),this.graphs.draw()},l.prototype.loaded=function(t,n,i){a(function(){return[function(t){function n(t){return o[t>>4&15]+o[15&t]}function i(t,e,i){var r,s,a,o,h,l,u,p;switch(1===arguments.length&&(e=t.s,i=t.v,t=t.h),o=Math.floor(6*t),h=6*t-o,l=i*(1-e),u=i*(1-h*e),p=i*(1-(1-h)*e),o%6){case 0:r=i,s=p,a=l;break;case 1:r=u,s=i,a=l;break;case 2:r=l,s=i,a=p;break;case 3:r=l,s=u,a=i;break;case 4:r=p,s=l,a=i;break;case 5:r=i,s=l,a=u}return"#"+n(Math.floor(255*r))+n(Math.floor(255*s))+n(Math.floor(255*a))}for(var r=new e(t,{plugins:{zoom:{zoomMode:"xy",transition:!0},drag:{persistanceX:!0,dragY:!1}}},{}),s=[],a=[],o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],h=0;h<10*Math.PI;h+=.001)s.push(h),s.push(Math.sin(h)),a.push(i(Math.pow(Math.sin(h),2),.8,.8));var l=r.newSerie("a",{},"line.color").autoAxis().setData(s);l.setColors([a]),r.draw();Date.now();r.drawSeries(!0);var u=0;for(var h in l.lines)u++;console.log(u)},"Basic example",["Setting up a chart takes only a couple lines. Call <code>new Graph( domElement );</code> to start a graph. Render it with <code>graph.redraw();</code>",'To add a serie, call <code>graph.newSerie( "serieName" )</code>. To set data, call <code>serie.setData()</code> method.']]}),this.setSerieX(i,t.x.spectra[0].data[0],{label:"SomeLabel"})},l.prototype.makeGraph=function(){var t=this;this.graphs=new e(this.getDom().children().get(0),{close:{left:!1,top:!1,right:!1},paddingBottom:0,paddingTop:0,paddingLeft:0,paddingRight:0,plugins:{zoom:{zoomMode:"x"},shape:{type:"nmrintegral",strokeColor:"#AF002A",fillColor:"transparent",strokeWidth:2,locked:!1,movable:!0,resizable:!0,selectable:!0,selectOnMouseDown:!0,handles:!0,labelEditable:!0,horizontal:!0,forcedCoords:{y:function(t){return 20+5*t.serie.getIndex()+"px"}},bindable:!0,axis:"x",labels:[{text:"Something",color:"red"}],attributes:{"data-bindable":function(){return 1}},onCreatedShape:function(e){t.integralCreated(e)},highlightOnMouseOver:!0}},mouseActions:[{plugin:"zoom",shift:!1,ctrl:!1},{plugin:"shape",shift:!0,ctrl:!1},{plugin:"zoom",shift:!1,type:"mousewheel",options:{baseline:0,direction:"y"}},{shift:!0,type:"mousewheel",callback:function(e){var n=e/300;t.heightIntegral1+=n,t.ratio=t.heightIntegral1/t.integrals[0].sum,t.recalculateIntegrals(),t.redrawIntegrals()}},{plugin:"zoom",shift:!1,type:"dblclick",options:{mode:"total"}}],onBeforeNewShape:function(){return!this.selectedSerie&&this.series.length>1?!1:void 0}}),this.graphs.setHeight(300),this.graphs.on("shapeChanged",function(e){"nmrintegral"==e.getType()&&t.integralChanged(e)}),this.graphs.on("shapeLabelChanged",function(e){"nmrintegral"==e.getType()&&t.integralValueChanged(e)}),this.graphs.draw()},l}),a("jquery",function(){return t}),a("jsgraph",function(){return e}),a("jcampconverter",function(){return n}),s("nmr")});
//# sourceMappingURL=jsnmr.min.js.map