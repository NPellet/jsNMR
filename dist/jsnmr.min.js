/*! jsNMR 0.0.7 | (c) 2014 Norman Pellet | http://github.com/NPellet/jsNMR/copyright.txt */
define(["jquery","jsgraph","jcampconverter"],function(t,e,n){var r,s,a;return function(t){function e(t,e){return x.call(t,e)}function i(t,e){var i,n,r,s,a,o,h,l,u,p,g,c,d=e&&e.split("/"),f=v.map,m=f&&f["*"]||{};if(t){for(t=t.split("/"),a=t.length-1,v.nodeIdCompat&&w.test(t[a])&&(t[a]=t[a].replace(w,"")),"."===t[0].charAt(0)&&d&&(c=d.slice(0,d.length-1),t=c.concat(t)),u=0;u<t.length;u++)if(g=t[u],"."===g)t.splice(u,1),u-=1;else if(".."===g){if(0===u||1===u&&".."===t[2]||".."===t[u-1])continue;u>0&&(t.splice(u-1,2),u-=2)}t=t.join("/")}if((d||m)&&f){for(i=t.split("/"),u=i.length;u>0;u-=1){if(n=i.slice(0,u).join("/"),d)for(p=d.length;p>0;p-=1)if(r=f[d.slice(0,p).join("/")],r&&(r=r[n])){s=r,o=u;break}if(s)break;!h&&m&&m[n]&&(h=m[n],l=u)}!s&&h&&(s=h,o=l),s&&(i.splice(0,o,s),t=i.join("/"))}return t}function n(e,i){return function(){var n=S.call(arguments,0);return"string"!=typeof n[0]&&1===n.length&&n.push(null),c.apply(t,n.concat([e,i]))}}function o(t){return function(e){return i(e,t)}}function h(t){return function(e){m[t]=e}}function l(i){if(e(b,i)){var n=b[i];delete b[i],y[i]=!0,g.apply(t,n)}if(!e(m,i)&&!e(y,i))throw new Error("No "+i);return m[i]}function u(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function p(t){return function(){return v&&v.config&&v.config[t]||{}}}var g,c,d,f,m={},b={},v={},y={},x=Object.prototype.hasOwnProperty,S=[].slice,w=/\.js$/;d=function(t,e){var n,r=u(t),s=r[0];return t=r[1],s&&(s=i(s,e),n=l(s)),s?t=n&&n.normalize?n.normalize(t,o(e)):i(t,e):(t=i(t,e),r=u(t),s=r[0],t=r[1],s&&(n=l(s))),{f:s?s+"!"+t:t,n:t,pr:s,p:n}},f={require:function(t){return n(t)},exports:function(t){var e=m[t];return"undefined"!=typeof e?e:m[t]={}},module:function(t){return{id:t,uri:"",exports:m[t],config:p(t)}}},g=function(i,r,s,a){var o,u,p,g,c,v,x=[],S=typeof s;if(a=a||i,"undefined"===S||"function"===S){for(r=!r.length&&s.length?["require","exports","module"]:r,c=0;c<r.length;c+=1)if(g=d(r[c],a),u=g.f,"require"===u)x[c]=f.require(i);else if("exports"===u)x[c]=f.exports(i),v=!0;else if("module"===u)o=x[c]=f.module(i);else if(e(m,u)||e(b,u)||e(y,u))x[c]=l(u);else{if(!g.p)throw new Error(i+" missing "+u);g.p.load(g.n,n(a,!0),h(u),{}),x[c]=m[u]}p=s?s.apply(m[i],x):void 0,i&&(o&&o.exports!==t&&o.exports!==m[i]?m[i]=o.exports:p===t&&v||(m[i]=p))}else i&&(m[i]=s)},r=s=c=function(e,i,n,r,s){if("string"==typeof e)return f[e]?f[e](i):l(d(e,i).f);if(!e.splice){if(v=e,v.deps&&c(v.deps,v.callback),!i)return;i.splice?(e=i,i=n,n=null):e=t}return i=i||function(){},"function"==typeof n&&(n=r,r=s),r?g(t,e,i,n):setTimeout(function(){g(t,e,i,n)},4),c},c.config=function(t){return c(t)},r._defined=m,a=function(t,i,n){if("string"!=typeof t)throw new Error("See almond README: incorrect module build, no module name");i.splice||(n=i,i=[]),e(m,t)||e(b,t)||(b[t]=[t,i,n])},a.amd={jQuery:!0}}(),a("build_utils/almond",function(){}),a("shape.1dnmr",["jquery","jsgraph"],function(t,e){"use strict";function i(t,e){this.options=e||2}var n=5,r=e.getConstructor("graph.shape.line");return t.extend(i.prototype,r.prototype,{createDom:function(){this._createHandles(2,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"}),this._dom=document.createElementNS(this.graph.ns,"line"),this.maxLines=64,this.nbLines=0,this.maxLines=0,this.lines=new Array(this.maxLines);for(var t=this.maxLines-1;t>=0;t--)this.lines[t]=document.createElementNS(this.graph.ns,"line"),this.group.appendChild(this.lines[t]),this.lines[t].setAttribute("stroke","green");var e,i=0,n=0,r=0,s=this.graph.series[0].data[0];for(e=0;e<s.length;e+=2)Math.abs(s[e+1])>r&&(r=Math.abs(s[e+1]));for(e=0;e<s.length;e+=2)i+=s[e+1]/r;for(e=0;e<s.length;e+=2)n+=Math.pow(i-s[e+1]/r,2);n=Math.sqrt(r)*Math.sqrt(2*n/s.length),this.noiseLevel=3*n,this._dom.element=this},redrawImpl:function(){this.setHandles(),this.redrawLines(n)},redrawLines:function(t){if(0!=this.maxLines){for(var e=this.findxs(),i=e.length-1;i>=0;i--){var n=this._getPosition({x:10}),r=this._getPosition({x:e[i][0]});this.lines[i]&&r.x&&this.currentPos2y&&this.currentPos1y&&i<this.maxLines&&(this.lines[i].setAttribute("stroke","green"),this.lines[i].setAttribute("x1",r.x),this.lines[i].setAttribute("x2",r.x),this.lines[i].setAttribute("y1",r.y),this.lines[i].setAttribute("y2",n.y),this.lines[i].setAttribute("on",!0))}for(var i=e.length;i<this.nbLines;i++)this.lines[i]&&(this.lines[i].setAttribute("y1",parseFloat(this.lines[i].getAttribute("y2"))),this.lines[i].setAttribute("x1",-1e6),this.lines[i].setAttribute("x2",-1e6),this.lines[i].setAttribute("on",!1));this.nbLines=e.length}},highLigthLinesY:function(t){for(var e=this.lines.length-1;e>=0;e--)"true"==this.lines[e].getAttribute("on")&&this.lines[e].setAttribute("y1",parseFloat(this.lines[e].getAttribute("y1"))-t)},findxs:function(){var t,e,i=this.serie.searchClosestValue(this.getFromData("pos").x),n=this.serie.searchClosestValue(this.getFromData("pos2").x),r=[],s=[];if(!i||!n)return!1;for(var a=i.dataIndex;a<=n.dataIndex;a++)for(t=a==i.dataIndex?i.xBeforeIndexArr:0,e=a==n.dataIndex?n.xBeforeIndexArr:this.serie.data[a].length,w=0,g=t;e>=g;g+=2)r.push(this.serie.data[a][g+0]),s.push(this.serie.data[a][g+1]);for(var a=s.length-1;a>=0;a--)Math.abs(s[a])<this.noiseLevel&&(s[a]=0);for(var o=r[1]-r[0],h=[],l=[],u=[],p=[],g=2;g<r.length-2;g++)l.push(1/35*(-3*s[g-2]+12*s[g-1]+17*s[g]+12*s[g+1]-3*s[g+2])),h.push(r[g]),u.push(1/(12*o)*(s[g-2]-8*s[g-1]+8*s[g+1]-s[g+2])),p.push(1/(7*Math.abs(2*o))*(2*s[g-2]-s[g-1]-2*s[g]-s[g+1]+2*s[g+2]));for(var c=[],d=[],f=[],m=[],a=1;a<l.length-1;a++){if(l[a]>l[a-1]&&l[a]>l[a+1]&&c.push(h[a]),u[a]<u[a-1]&&u[a]<u[a+1]&&d.push(h[a]),u[a]>u[a-1]&&u[a]>u[a+1])try{f.push([h[a],d.pop()])}catch(b){console.log("Error I don't know why")}p[a]<p[a-1]&&p[a]<p[a+1]&&m.push([h[a],l[a]])}for(var v=new Array,g=0;g<m.length;g++){for(var y=m[g],x=y[0],S=new Array,w=0;w<f.length;w++){var a=f[w];x>a[0]&&x<a[1]&&S.push(a)}if(S.length>0&&1==S.length){var A=S[0],j=A[1]-A[0],L=y[1],G=l;G.sort(function(t,e){return t-e}),j>2*o&&L>1e-4*G[0]&&v.push([x,j,L])}}return v}}),i}),a("assignment",["jquery"],function(t){"use strict";var e="http://www.w3.org/2000/svg",i=function(i){var n=this;this.options=i,this.bindingPairs=[];var r,s,a=!1,o=!1,h=!1,l={},u=[],p=[],g=function(e,o,h){if(B(),o.shiftKey){for(var l in i.graphs)i.graphs[l].lockShapes();a=!0,n[h]=e,o.preventDefault(),o.stopPropagation()}var u=e.getBBox(),p=t(e).position(),g=p.left+u.width/2,f=p.top+u.height/2;if(r.setAttribute("display","block"),r.setAttribute("x1",g),r.setAttribute("x2",g),r.setAttribute("y1",f),r.setAttribute("y2",f),s=c(h),i[c(h)].targettable){var m=d(c(h));m.each(function(){this.jsGraphIsShape?this.jsGraphIsShape.highlight(i[c(h)].targettable,"binding"):(S(i[c(h)].targettable,t(this)),t(this).attr(i[c(h)].targettable))})}},c=function(t){return"jsGraphShape"==t?"targetB":"jsGraphShape"},d=function(e){return t(i[e].dom).find(i[e].bindableFilter)},f=function(e,o,h){if(B(),s&&i[s].targettable){var l=d(s);l.each(function(){this.jsGraphIsShape?this.jsGraphIsShape.unHighlight("binding"):w(i[s].targettable,t(this))})}if(s=!1,a&&!h)return r.setAttribute("display","none"),void(a=!1);if(a){var u=o.target;r.setAttribute("display","none"),!t(u).is(i[h].bindableFilter)&&!t(u).get(0).classList.contains(i[h].bindableFilterClass)>-1?a=!1:(n[h]=o.target,a=!1,G());for(var p in i.graphs)i.graphs[p].unlockShapes()}},m=function(t){B(),a&&(r.setAttribute("x2",t.clientX+window.scrollX),r.setAttribute("y2",t.clientY+window.scrollY))},b=function(e,n){B();var r=[e];i[n].highlighted&&(r=x(n,e),y(n,r));for(var s=[],a=0,o=r.length;o>a;a++)A(j,r[a],function(e){s=s.concat(t.makeArray(x(c(n),e[c(n)])))});s=t(s),i[c(n)].highlighted&&y(c(n),s)},v=function(e,n,r){B();for(var s=x(n,e),a=[],o=0;o<s.length;o++)A(L,s[o],function(e){a=a.concat(t.makeArray(x(c(n),e[c(n)])))});l.jsGraphShape.map(function(t){this.jsGraphIsShape.unHighlight("assignmentHighlighted")}),w(i.targetB.highlighted,l.targetB)},y=function(t,e){var n=i[t].highlighted;e[0]&&e[0].jsGraphIsShape?e.map(function(t){this.jsGraphIsShape.highlight(n,"assignmentHighlighted")}):(S(n,e),e.attr(n)),l[t]=e},x=function(e,n){var r=n.getAttribute(i[e].attributeEquivalents);return t(i[e].dom).find("["+i[e].attributeEquivalents+'="'+r+'"]')},S=function(e,i){for(var n in e)for(var r=0,s=i.length;s>r;r++)t(i[r]).data("backup-"+n)||t(i[r]).data("backup-"+n,t(i[r]).attr(n))},w=function(e,i){for(var n in e)for(var r=0,s=i.length;s>r;r++)t(i[r]).attr(n,t(i[r]).data("backup-"+n))},A=function(t,e,i){for(var r=0,s=n.bindingPairs.length;s>r;r++)(n.bindingPairs[r].jsGraphShape==e||n.bindingPairs[r].targetB==e)&&(t(n.bindingPairs[r]),i&&i(n.bindingPairs[r]))},j=function(n){var r,s=t(n.jsGraphShape).offset(),a=t(n.targetB).offset(),o=t(n.jsGraphShape)[0].getBBox(),h=t(n.targetB)[0].getBBox(),l=i.domGlobal.offset();u.length>0?(r=u.pop(),r.setAttribute("display","block")):r=document.createElementNS(e,"line"),r.setAttribute("stroke","black"),r.setAttribute("x1",s.left-l.left+o.width/2),r.setAttribute("y1",s.top-l.top+o.height/2),r.setAttribute("x2",a.left-l.left+h.width/2),r.setAttribute("y2",a.top-l.top+h.height/2),n.line=r,p.push(r),C.appendChild(r)},L=function(t){t.line=!1,p.map(function(t){t.setAttribute("display","none")}),u=u.concat(p),p=[]},G=function(){var t;return(t=k(n.jsGraphShape,n.targetB))?(E(t),L(t),!1):(v(n.jsGraphShape,"jsGraphShape",!0),n.bindingPairs.push({jsGraphShape:n.jsGraphShape,targetB:n.targetB}),n.jsGraphShape.jsGraphIsShape.setStrokeDasharray("5,5"),n.jsGraphShape.jsGraphIsShape.applyStyle(),o=null,void(h=null))},E=function(t){n.bindingPairs.splice(n.bindingPairs.indexOf(t),1),L(t)},k=function(t,e){for(var i=0;i<n.bindingPairs.length;i++)if(n.bindingPairs[i].jsGraphShape==t||n.bindingPairs[i].targetB==e)return n.bindingPairs[i];return!1},B=function(){for(var e=0,r=n.bindingPairs.length;r>e;e++)t(i.jsGraphShape.dom).get(0).contains(n.bindingPairs[e].jsGraphShape)&&t(i.targetB.dom).get(0).contains(n.bindingPairs[e].targetB)||(n.bindingPairs[e]=!1)},P=function(){i.jsGraphShape.dom.on("mousedown",i.jsGraphShape.bindableFilter,function(t){g(this,t,"jsGraphShape")}),i.jsGraphShape.dom.on("mouseover",i.jsGraphShape.bindableFilter,function(t){b(this,"jsGraphShape")}),i.jsGraphShape.dom.on("mouseout",i.jsGraphShape.bindableFilter,function(t){v(this,"jsGraphShape")}),i.targetB.dom.on("mousedown",i.targetB.bindableFilter,function(t){g(this,t,"targetB")}),i.targetB.dom.on("mouseover",i.targetB.bindableFilter,function(t){b(this,"targetB")}),i.targetB.dom.on("mouseout",i.targetB.bindableFilter,function(t){v(this,"targetB")}),i.jsGraphShape.dom.on("mouseup",function(t){f(this,t,"jsGraphShape")}),i.targetB.dom.on("mouseup",function(t){f(this,t,"targetB")}),i.domGlobal.on("mouseup",function(t){f(this,t,!1)}),i.domGlobal.on("mousemove",function(t){m(t)})},C=document.createElementNS(e,"svg");C.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),C.setAttribute("xmlns",e),C.setAttribute("style","position: absolute"),C.setAttribute("width",i.domGlobal.width()),C.setAttribute("height",i.domGlobal.height()),C.setAttribute("pointer-events","none"),r=document.createElementNS(e,"line"),r.setAttribute("stroke","black"),C.appendChild(r),i.domGlobal.prepend(C),P()};return i.prototype.getAssignment=function(){var t=this;return this.bindingPairs.map(function(e){if(e){var i=e.jsGraphShape.getAttribute(t.options.jsGraphShape.attributeEquivalents),n=e.targetB.getAttribute(t.options.targetB.attributeEquivalents);return[i,n]}})},i.prototype.removePairsWithShape=function(t){var e=this;this.lookForPairsByA(t).map(function(t){e.removePair(t)})},i.prototype.findElement=function(e,i){return t(this.options[e].dom).find("["+this.options[e].attributeEquivalents+'="'+i+'"]')},i.prototype.setAssignment=function(t){var e=this;e.bindingPairs=[],t.forEach(function(t){e.bindingPairs.push({jsGraphShape:e.findElement("jsGraphShape",t[0]),targetB:e.findElement("targetB",t[1])})})},i}),function(){"use strict";function t(){}function e(t,e){for(var i=t.length;i--;)if(t[i].listener===e)return i;return-1}function i(t){return function(){return this[t].apply(this,arguments)}}var n=t.prototype,r=this,s=r.EventEmitter;n.getListeners=function(t){var e,i,n=this._getEvents();if(t instanceof RegExp){e={};for(i in n)n.hasOwnProperty(i)&&t.test(i)&&(e[i]=n[i])}else e=n[t]||(n[t]=[]);return e},n.flattenListeners=function(t){var e,i=[];for(e=0;e<t.length;e+=1)i.push(t[e].listener);return i},n.getListenersAsObject=function(t){var e,i=this.getListeners(t);return i instanceof Array&&(e={},e[t]=i),e||i},n.addListener=function(t,i){var n,r=this.getListenersAsObject(t),s="object"==typeof i;for(n in r)r.hasOwnProperty(n)&&-1===e(r[n],i)&&r[n].push(s?i:{listener:i,once:!1});return this},n.on=i("addListener"),n.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},n.once=i("addOnceListener"),n.defineEvent=function(t){return this.getListeners(t),this},n.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},n.removeListener=function(t,i){var n,r,s=this.getListenersAsObject(t);for(r in s)s.hasOwnProperty(r)&&(n=e(s[r],i),-1!==n&&s[r].splice(n,1));return this},n.off=i("removeListener"),n.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},n.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},n.manipulateListeners=function(t,e,i){var n,r,s=t?this.removeListener:this.addListener,a=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(n=i.length;n--;)s.call(this,e,i[n]);else for(n in e)e.hasOwnProperty(n)&&(r=e[n])&&("function"==typeof r?s.call(this,n,r):a.call(this,n,r));return this},n.removeEvent=function(t){var e,i=typeof t,n=this._getEvents();if("string"===i)delete n[t];else if(t instanceof RegExp)for(e in n)n.hasOwnProperty(e)&&t.test(e)&&delete n[e];else delete this._events;return this},n.removeAllListeners=i("removeEvent"),n.emitEvent=function(t,e){var i,n,r,s,a,o=this.getListenersAsObject(t);for(s in o)if(o.hasOwnProperty(s))for(i=o[s].slice(0),r=0;r<i.length;r++)n=i[r],n.once===!0&&this.removeListener(t,n.listener),a=n.listener.apply(this,e||[]),a===this._getOnceReturnValue()&&this.removeListener(t,n.listener);return this},n.trigger=i("emitEvent"),n.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},n.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},n._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},n._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return r.EventEmitter=s,t},"function"==typeof a&&a.amd?a("../lib/components/eventEmitter/EventEmitter",[],function(){return t}):"object"==typeof module&&module.exports?module.exports=t:r.EventEmitter=t}.call(this),a(["jquery","jsgraph","./shape.1dnmr","./assignment","jcampconverter","../lib/components/eventEmitter/EventEmitter"],function(t,e,n,r,s,o){function h(e,i,n){var r=[];for(var a in i)r.push(t.get(i[a]).then(function(t){return s.convert(t,{keepSpectra:!0})}));e.divLoading||(e.divLoading=t("<div />").css({width:e.getDom().width(),height:e.getDom().height(),position:"absolute",backgroundColor:"rgba(200, 200, 200, 0.5)",textAlign:"center",lineHeight:e.getDom().height()+"px",fontSize:"2em",border:"1px solid #c0c0c0"}).html("Loading..."),e.getDom().prepend(e.divLoading)),e.loading=e.loading||0,e.loading++,t.when.apply(t,r).then(function(){var t=0;for(a in i)i[a]=arguments[t],t++;e.loading--,0==e.loading&&(e.divLoading.remove(),e.divLoading=!1),e.series.push(i),e.loaded(i,n,"a"+Math.random())})}function l(e){var i=this;switch(this.options=t.extend(!0,{},u,e),this.series=[],this.graphs,this.integrals=[],i.options.dom.append("<div />"),i.makeGraph(),this.options.mode){case"2d":break;case"1d":this.legend=this.graphs.makeLegend({frame:!0,frameWidth:2,frameColor:"grey",movable:!0,backgroundColor:"white"}),this.legend.setPosition({x:"300px",y:"40px"},"right")}this.options.assignment&&(this.assignement=new r(t.extend(this.options.assignment,{graphs:{x:this.graphs},domGraphs:this.options.dom}))),this.heightIntegral1=150}var u={mode:"1d",molecule:!1,urls:{}};e.registerConstructor("graph.shape.1dnmr",n);var p={urls:{}};return l.prototype=new o,l.prototype.load=function(e){var e=t.extend(!0,{},p,e),i={};switch(this.options.mode){case"1d":e.urls.oneD=e.url||e.urls.oneD||e.urls.x,i.x=e.urls.oneD}h(this,i,e)},l.prototype.integralCreated=function(t){this.graphs.selectedSerie?t.setSerie(this.graphs.selectedSerie):t.setSerie(this.graphs.getSerie(0)),t.addClass("bindable"),this.integrals.push(t),this.emit("integralCreated")},l.prototype.integralChanged=function(t){this.recalculateIntegrals(),this.emit("integralChanged")},l.prototype.integralRemoved=function(t){nmr.integrals.splice(nmr.integrals.indexOf(i),1),nmr.recalculateIntegrals(),this.assignement.removePairsWithShape(t),this.emit("integralRemoved")},l.prototype.recalculateIntegrals=function(){var t=this,e=t.integrals.length;1==e&&(t.ratio=t.heightIntegral1/t.integrals[0].sum,t.ratioSum=t.integrals[0].sum);for(var i=0;e>i;i++){t.integrals[i].ratio=t.ratio;var n=Math.round(t.integrals[i].sum/t.ratioSum*100)/100;isNaN(n)||t.integrals[i].setLabelText(n),t.integrals[i].updateLabels()}},l.prototype.redrawIntegrals=function(){for(var t=this.integrals.length,e=0;t>e;e++)this.integrals[e].redraw()},l.prototype.integralValueChanged=function(t){var e=parseFloat(t.getLabelText(0));this.ratioSum=t.sum/e,this.recalculateIntegrals(),this.emit("integralValueChanged")},l.prototype.getDom=function(){return this.options.dom},l.prototype.getGraph=function(){return this.graphs},l.prototype.resizeTo=function(t,e){this.graphs.resize(t,e)},l.prototype.setSerieX=function(e,i,n){this.graphs.getSerie(e)&&(this.graphs.getSerie(e).kill(),this.graphs.removeShapes(),this.integralBasis=!1);var r=this.graphs.newSerie(e,t.extend({useSlots:!0},n)).setLabel("My serie").autoAxis().setData(i).XIsMonotoneous();n.lineColor&&r.setLineColor(n.lineColor),n.lineWidth&&r.setLineWidth(n.lineWidth),n.setLineStyle&&r.setLineStyle(n.lineStyle),r.XIsMonotoneous(),r.getXAxis().setAxisDataSpacingMax(0),r.getXAxis().setAxisDataSpacingMin(0),r.getYAxis().setDisplay(!1).primaryGridOff(!1).secondaryGridOff(!1),r.getXAxis().flip(!0).setLabel("ppm").primaryGridOff(!1).secondaryGridOff(!1).setTickPosition("outside"),this.graphs.autoscaleAxes(),this.graphs.draw()},l.prototype.loaded=function(t,i,n){a(function(){return[function(t){function i(t){return o[t>>4&15]+o[15&t]}function n(t,e,n){var r,s,a,o,h,l,u,p;switch(1===arguments.length&&(e=t.s,n=t.v,t=t.h),o=Math.floor(6*t),h=6*t-o,l=n*(1-e),u=n*(1-h*e),p=n*(1-(1-h)*e),o%6){case 0:r=n,s=p,a=l;break;case 1:r=u,s=n,a=l;break;case 2:r=l,s=n,a=p;break;case 3:r=l,s=u,a=n;break;case 4:r=p,s=l,a=n;break;case 5:r=n,s=l,a=u}return"#"+i(Math.floor(255*r))+i(Math.floor(255*s))+i(Math.floor(255*a))}for(var r=new e(t,{plugins:{zoom:{zoomMode:"xy",transition:!0},drag:{persistanceX:!0,dragY:!1}}},{}),s=[],a=[],o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],h=0;h<10*Math.PI;h+=.001)s.push(h),s.push(Math.sin(h)),a.push(n(Math.pow(Math.sin(h),2),.8,.8));var l=r.newSerie("a",{},"line.color").autoAxis().setData(s);l.setColors([a]),r.draw();Date.now();r.drawSeries(!0);var u=0;for(var h in l.lines)u++;console.log(u)},"Basic example",["Setting up a chart takes only a couple lines. Call <code>new Graph( domElement );</code> to start a graph. Render it with <code>graph.redraw();</code>",'To add a serie, call <code>graph.newSerie( "serieName" )</code>. To set data, call <code>serie.setData()</code> method.']]}),this.setSerieX(n,t.x.spectra[0].data[0],{label:"SomeLabel"})},l.prototype.makeGraph=function(){var t=this;this.graphs=new e(this.getDom().children().get(0),{close:{left:!1,top:!1,right:!1},paddingBottom:0,paddingTop:0,paddingLeft:0,paddingRight:0,plugins:{zoom:{zoomMode:"x"},shape:{type:"nmrintegral",strokeColor:"#AF002A",fillColor:"transparent",strokeWidth:2,locked:!1,movable:!0,resizable:!0,selectable:!0,selectOnMouseDown:!0,handles:!0,labelEditable:!0,horizontal:!0,forcedCoords:{y:function(t){return 20+5*t.serie.getIndex()+"px"}},bindable:!0,axis:"x",labels:[{text:"Something",color:"red"}],attributes:{"data-bindable":function(){return 1}},onCreatedShape:function(e){t.integralCreated(e)},highlightOnMouseOver:!0}},mouseActions:[{plugin:"zoom",shift:!1,ctrl:!1},{plugin:"shape",shift:!0,ctrl:!1},{plugin:"zoom",shift:!1,type:"mousewheel",options:{baseline:0,direction:"y"}},{shift:!0,type:"mousewheel",callback:function(e){var i=e/300;t.heightIntegral1+=i,t.ratio=t.heightIntegral1/t.integrals[0].sum,t.recalculateIntegrals(),t.redrawIntegrals()}},{plugin:"zoom",shift:!1,type:"dblclick",options:{mode:"total"}}],onBeforeNewShape:function(){return!this.selectedSerie&&this.series.length>1?!1:void 0}}),this.graphs.setHeight(300),this.graphs.on("shapeChanged",function(e){"nmrintegral"==e.getType()&&t.integralChanged(e)}),this.graphs.on("shapeLabelChanged",function(e){"nmrintegral"==e.getType()&&t.integralValueChanged(e)}),this.graphs.draw()},l}),a("jquery",function(){return t}),a("jsgraph",function(){return e}),a("jcampconverter",function(){return n}),s("nmr")});
//# sourceMappingURL=jsnmr.min.js.map